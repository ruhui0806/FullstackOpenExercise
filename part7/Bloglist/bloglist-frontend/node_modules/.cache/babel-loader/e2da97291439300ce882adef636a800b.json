{"ast":null,"code":"var _jsxFileName = \"/Users/befantastic/my_repos/bloglist-frontend/src/App.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport Blog from './components/Blog';\nimport blogService from './services/blogs';\nimport loginService from './services/login';\nimport Notification from './components/Notification';\nimport LoginForm from './components/LoginForm';\nimport BlogForm from './components/BlogForm';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst App = () => {\n  _s();\n\n  const [blogs, setBlogs] = useState([]);\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [user, setUser] = useState(null);\n  const [message, setMessage] = useState(null);\n  const [loginVisible, setLoginVisible] = useState(false);\n  const [blogVisible, setBlogVisible] = useState(false);\n  useEffect(() => {\n    blogService.getAll().then(blogs => setBlogs(blogs));\n  }, []);\n  useEffect(() => {\n    const loggedUserJSON = window.localStorage.getItem(\"loggedBlogappUser\");\n\n    if (loggedUserJSON) {\n      const user = JSON.parse(loggedUserJSON);\n      setUser(user);\n      blogService.setToken(user.token);\n    }\n  }, []);\n\n  const handleLogin = async event => {\n    event.preventDefault();\n\n    try {\n      const user = await loginService.login({\n        username,\n        password\n      });\n      setUser(user);\n      blogService.setToken(user.token);\n      window.localStorage.setItem(\"loggedBlogappUser\", JSON.stringify(user));\n      setUsername(\"\");\n      setPassword(\"\");\n    } catch (exception) {\n      setMessage(\"Wrong username or password\");\n      setTimeout(() => {\n        setMessage(null);\n      }, 1000);\n    }\n  };\n\n  const handleLogout = () => {\n    setUser(null);\n    window.localStorage.removeItem('loggedBlogappUser');\n  };\n\n  const loginForm = () => /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"log in to application\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: loginVisible ? 'none' : ''\n      },\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setLoginVisible(true),\n        children: \"Click to login\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Notification, {\n      message: message,\n      style: {\n        color: 'red',\n        borderStyle: 'solid',\n        borderColor: 'red',\n        background: 'lightgray',\n        fontSize: 20\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: loginVisible ? '' : 'none'\n      },\n      children: [/*#__PURE__*/_jsxDEV(LoginForm, {\n        onSubmit: handleLogin,\n        username: username,\n        password: password,\n        handleUsernameChange: _ref => {\n          let {\n            target\n          } = _ref;\n          return setUsername(target.value);\n        },\n        handlePasswordChange: _ref2 => {\n          let {\n            target\n          } = _ref2;\n          return setPassword(target.value);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setLoginVisible(false),\n        children: \"Cancel\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n\n  const addBlog = blogObject => {\n    blogService.createNew(blogObject).then(returnedBlog => {\n      setBlogs(blogs.concat(returnedBlog));\n    });\n  };\n\n  const addBlogNotification = blogObject => {\n    setMessage(`a new blog ${blogObject.title} by ${blogObject.author}`);\n    setTimeout(() => {\n      setMessage(null);\n    }, 5000);\n  };\n\n  const updateLikes = id => {\n    const blog = blogs.find(blog => blog.id === id);\n    const changedBlog = { ...blog,\n      likes: blog.likes + 1\n    };\n    blogService.update(id, changedBlog).then(returnedBlog => {\n      setBlogs(blogs.map(blog => blog.id !== id ? blog : returnedBlog));\n    });\n  };\n\n  const removeBlogof = id => {\n    const blog = blogs.find(blog => blog.id === id);\n\n    if (window.confirm(`Delete ${blog.title} ?`)) {\n      blogService.remove(id).then(setBlogs(blogs.filter(blog => blog.id !== id))).then(setMessage(`Remove blog ${blog.title} by ${blog.author}`));\n      setTimeout(() => {\n        setMessage(null);\n      }, 1000);\n    }\n  };\n\n  const SortBlogbyLikes = (a, b) => {\n    return b.likes - a.likes;\n  };\n\n  const BlogsList = () => /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"blogs\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Notification, {\n      message: message,\n      style: {\n        color: 'green',\n        borderStyle: 'solid',\n        borderColor: 'green',\n        background: 'lightgray',\n        fontSize: 20\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n      children: [\" \", user.name, \" logged in\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleLogout,\n      children: \"log out\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: blogVisible ? 'none' : ''\n      },\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setBlogVisible(true),\n        children: \"new note\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: blogVisible ? '' : 'none'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"create new\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(BlogForm, {\n        handleSubmit: addBlog,\n        handleNotification: addBlogNotification\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setBlogVisible(false),\n        children: \"Cancel\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 7\n    }, this), blogs.sort(SortBlogbyLikes).map(blog => /*#__PURE__*/_jsxDEV(Blog, {\n      blog: blog,\n      addLikes: () => updateLikes(blog.id),\n      removeBlog: () => removeBlogof(blog.id)\n    }, blog.id, false, {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 9\n    }, this))]\n  }, void 0, true);\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [user === null && loginForm(), user !== null && BlogsList(), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 152,\n    columnNumber: 5\n  }, this);\n};\n\n_s(App, \"ebctjyFEMCbCQ3aqGZK1aflWJgk=\");\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["/Users/befantastic/my_repos/bloglist-frontend/src/App.js"],"names":["React","useState","useEffect","Blog","blogService","loginService","Notification","LoginForm","BlogForm","App","blogs","setBlogs","username","setUsername","password","setPassword","user","setUser","message","setMessage","loginVisible","setLoginVisible","blogVisible","setBlogVisible","getAll","then","loggedUserJSON","window","localStorage","getItem","JSON","parse","setToken","token","handleLogin","event","preventDefault","login","setItem","stringify","exception","setTimeout","handleLogout","removeItem","loginForm","display","color","borderStyle","borderColor","background","fontSize","target","value","addBlog","blogObject","createNew","returnedBlog","concat","addBlogNotification","title","author","updateLikes","id","blog","find","changedBlog","likes","update","map","removeBlogof","confirm","remove","filter","SortBlogbyLikes","a","b","BlogsList","name","sort"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport Blog from './components/Blog'\nimport blogService from './services/blogs'\nimport loginService from './services/login'\nimport Notification from './components/Notification'\nimport LoginForm from './components/LoginForm'\nimport BlogForm from './components/BlogForm'\n\nconst App = () => {\n  const [blogs, setBlogs] = useState([])\n  const [username, setUsername] = useState('')\n  const [password, setPassword] = useState('')\n  const [user, setUser] = useState(null)\n  const [message, setMessage] = useState(null)\n\n\n  const [loginVisible, setLoginVisible] = useState(false)\n  const [blogVisible, setBlogVisible] = useState(false)\n\n  useEffect(() => {\n    blogService.getAll().then(blogs =>\n      setBlogs(blogs)\n    )\n  }, [])\n\n  useEffect(() => {\n    const loggedUserJSON = window.localStorage.getItem(\"loggedBlogappUser\")\n    if (loggedUserJSON) {\n      const user = JSON.parse(loggedUserJSON)\n      setUser(user)\n      blogService.setToken(user.token)\n    }\n  }, [])\n\n  const handleLogin = async (event) => {\n    event.preventDefault()\n    try {\n      const user = await loginService.login({\n        username, password,\n      })\n\n      setUser(user)\n      blogService.setToken(user.token)\n      window.localStorage.setItem(\"loggedBlogappUser\", JSON.stringify(user))\n      setUsername(\"\")\n      setPassword(\"\")\n    }\n    catch (exception) {\n      setMessage(\"Wrong username or password\")\n      setTimeout(() => {\n        setMessage(null)\n      }, 1000)\n    }\n  }\n\n  const handleLogout = () => {\n    setUser(null)\n    window.localStorage.removeItem('loggedBlogappUser')\n  }\n\n\n\n  const loginForm = () => (\n    <>\n      <h2>log in to application</h2>\n      <div style={{ display: loginVisible ? 'none' : '' }}>\n        <button onClick={() => setLoginVisible(true)}>Click to login</button>\n\n      </div>\n      <Notification message={message} style={{ color: 'red', borderStyle: 'solid', borderColor: 'red', background: 'lightgray', fontSize: 20 }} />\n      <div style={{ display: loginVisible ? '' : 'none' }}>\n        <LoginForm onSubmit={handleLogin} username={username} password={password} handleUsernameChange={({ target }) => setUsername(target.value)} handlePasswordChange={({ target }) => setPassword(target.value)} />\n        <button onClick={() => setLoginVisible(false)}>Cancel</button>\n      </div>\n    </>\n  )\n\n\n  const addBlog = (blogObject) => {\n\n    blogService\n      .createNew(blogObject)\n      .then(returnedBlog => {\n        setBlogs(blogs.concat(returnedBlog))\n      })\n  }\n  const addBlogNotification = (blogObject) => {\n    setMessage(`a new blog ${blogObject.title} by ${blogObject.author}`)\n    setTimeout(() => {\n      setMessage(null)\n    }, 5000)\n  }\n\n\n  const updateLikes = (id) => {\n    const blog = blogs.find(blog => blog.id === id)\n    const changedBlog = { ...blog, likes: blog.likes + 1 }\n\n    blogService\n      .update(id, changedBlog)\n      .then(returnedBlog => {\n        setBlogs(blogs.map(blog => blog.id !== id ? blog : returnedBlog))\n      })\n  }\n\n  const removeBlogof = (id) => {\n    const blog = blogs.find(blog => blog.id === id)\n    if (window.confirm(`Delete ${blog.title} ?`)) {\n      blogService\n        .remove(id)\n        .then(setBlogs(blogs.filter(blog => blog.id !== id)))\n        .then(setMessage(`Remove blog ${blog.title} by ${blog.author}`))\n      setTimeout(() => {\n        setMessage(null)\n      }, 1000)\n    }\n  }\n\n  const SortBlogbyLikes = (a, b) => {\n    return b.likes - a.likes\n  }\n\n\n  const BlogsList = () => (\n    <>\n      <h2>blogs</h2>\n      <Notification message={message} style={{ color: 'green', borderStyle: 'solid', borderColor: 'green', background: 'lightgray', fontSize: 20 }} />\n      <h3> {user.name} logged in</h3>\n      <button onClick={handleLogout}>log out</button>\n      <br />\n\n      <div style={{ display: blogVisible ? 'none' : '' }}>\n        <button onClick={() => setBlogVisible(true)}>new note</button>\n      </div>\n\n      <div style={{ display: blogVisible ? '' : 'none' }}>\n        <h3>create new</h3>\n        <BlogForm handleSubmit={addBlog} handleNotification={addBlogNotification} />\n        <button onClick={() => setBlogVisible(false)}>Cancel</button>\n      </div>\n\n\n      {blogs.sort(SortBlogbyLikes).map(blog =>\n        <Blog key={blog.id} blog={blog} addLikes={() => updateLikes(blog.id)} removeBlog={() => removeBlogof(blog.id)} />\n      )}\n\n    </>\n\n  )\n\n  return (\n    <div>\n\n      {user === null && loginForm()}\n      {user !== null && BlogsList()}\n\n      <br />\n\n    </div>\n  )\n}\n\nexport default App"]},"metadata":{},"sourceType":"module"}